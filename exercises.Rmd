---
title: SQL Exercises
output: 
  learnr::tutorial:
    progressive: true
    allow_skip: true
runtime: shiny_prerendered
---

<style>
.title {
  margin-bottom: 0; /* Reduces space below the title */
}
.author {
  margin-top: 0; /* Reduces space above the author */
}
</style>

<div class="title">
  <h1>SQL Exercises on Seattle and Portland Flights data</h1>
</div>
<div class="author">
  <h3>Author: Dr. Chester Ismay</h3>
</div>

```{r setup, include=FALSE}
library(learnr)
suppressPackageStartupMessages(library(gradethis))
library(DBI)
library(RSQLite)
suppressPackageStartupMessages(library(tidyverse))

# Copy data over into this folder
# file.copy(from = "../flights2023/pnwflights23/data/airlines.rda", 
#           to = "data/airlines.rda")
# file.copy(from = "../flights2023/pnwflights23/data/airports.rda",
#           to = "data/airports.rda")
# file.copy(from = "../flights2023/pnwflights23/data/flights.rda",
#           to = "data/flights.rda")
# file.copy(from = "../flights2023/pnwflights23/data/planes.rda",
#           to = "data/planes.rda")
# file.copy(from = "../flights2023/pnwflights23/data/weather.rda",
#           to = "data/weather.rda")

# Read data in from RDA files
load("data/airlines.rda")
load("data/airports.rda")
load("data/flights.rda")
load("data/planes.rda")
load("data/weather.rda")

## Create an ephemeral in-memory RSQLite database
con <- dbConnect(SQLite(), ":memory:")

# Write the new data to the database
dbWriteTable(con, "airlines", airlines, overwrite = TRUE)
dbWriteTable(con, "airports", airports, overwrite = TRUE)
dbWriteTable(con, "flights", flights, overwrite = TRUE)
dbWriteTable(con, "planes", planes, overwrite = TRUE)
dbWriteTable(con, "weather", weather, overwrite = TRUE)

knitr::opts_chunk$set(connection = "con", 
                      max.print = 20)
```

```{r setup2, echo=FALSE, out.width='100%', fig.align='center'}
tutorial_options(exercise.cap = "Query", 
                 exercise.eval = FALSE,
                 exercise.reveal_solution = TRUE)

library(DiagrammeR)
# https://github.com/bergant/datamodelr
library(datamodelr)

dm_f <- dm_from_data_frames(airlines, airports, flights, planes, weather)

dm_f <- dm_add_references(
  dm_f,
  
  flights$carrier == airlines$carrier,
  flights$origin == airports$faa,
  flights$dest == airports$faa,
  flights$tailnum == planes$tailnum,
  weather$origin == airports$faa
)

graph <- dm_create_graph(dm_f, rankdir = "BT", col_attr = c("column", "type"))

dm_render_graph(graph)
```

<style>
.small-yellow-btn {
padding: 5px 10px; /* Adjust padding to reduce size */
font-size: 12px; /* Smaller font size */
border-radius: 5px; /* Adjust border radius for rounded corners */
background-color: yellow; /* Set background color to yellow */
color: black; /* Text color */
border: 1px solid darkgray; /* Optional: add border */
}
</style>

<style>
.hint-container {
margin-left: 40px; /* Adjust indentation as needed */
}
</style>

# Selection Techniques

## Selecting columns/fields

1. Select all airline names from the `airlines` table.

```{sql query1, exercise=TRUE, exercise.eval=FALSE}
-- Write your SQL query here to select all airline names from the airlines table
```

```{sql query1-hint-1}
-- HINT: The syntax for selecting all columns from a table is:
SELECT ___
FROM ___;
```

```{sql query1-hint-2}
-- HINT: The syntax for selecting specific columns from airlines is:
SELECT ___
FROM airlines;
```

```{sql query1-solution}
-- SOLUTION: Here's one way to select all airline names from the airlines table
SELECT name
FROM airlines;
```

```{r query1-check, echo=FALSE}
grade_this({
  # Execute the solution query to get the correct result
  .solution <- DBI::dbGetQuery(con, .solution_code)
  
  # Execute the student's query
  .result <- DBI::dbGetQuery(con, .user_code)
  
  # Dynamically get expected columns from the solution
  cols_expected <- names(.solution)
  
  # Check for missing or extra columns
  missing_cols <- setdiff(cols_expected, names(.result))
  extra_cols <- setdiff(names(.result), cols_expected)
  
  if (length(missing_cols) > 0) {
    fail(glue::glue("Your query is missing the following columns: {toString(missing_cols)}."))
  }
  
  if (length(extra_cols) > 0) {
    fail(glue::glue("Your query should not include the following columns: {toString(extra_cols)}."))
  }
  
  # Check for matching row counts
  if (nrow(.result) != nrow(.solution)) {
    fail("The number of rows returned by your query does not match the expected result.")
  }
  
  # Check if all values in each column match, allowing for different row orders
  all_columns_match <- TRUE
  for (column in cols_expected) {
    if (!identical(sort(.result[[column]]), sort(.solution[[column]]))) {
      all_columns_match <- FALSE
      break
    }
  }
  
  if (!all_columns_match) {
    fail("The values returned by your query do not match the expected result in one or more columns.")
  }
  
  # If all checks pass
  pass("Your query appears to be correct.")
})
```


2. Select all columns from the `weather` table.

```{sql query2, exercise=TRUE, exercise.eval=FALSE}
-- Write your SQL query here to select all columns/fields from the weather table
```

```{sql query2-hint-1}
-- HINT: Use SELECT * to select all columns from a table.
SELECT *
___ ___;
```

```{sql query2-hint-2}
-- HINT: Use FROM to specify which table to pull all columns from.
SELECT *
FROM ___;
```

```{sql query2-solution}
-- SOLUTION: Here is one way to select all fields from the `weather` table:
SELECT *
FROM weather;
```

```{r query2-check, echo=FALSE}
grade_this({
  # Execute the solution query to get the correct result
  .solution_ex2 <- DBI::dbGetQuery(con, .solution_code)
  
  # Execute the student's query
  .result_ex2 <- DBI::dbGetQuery(con, .user_code)
  
  # Use the grading logic from EXERCISE 1, adapted for EXERCISE 2
  # Dynamically get expected columns from the solution for EXERCISE 2
  cols_expected_ex2 <- names(.solution_ex2)
  
  # Check for missing or extra columns
  missing_cols_ex2 <- setdiff(cols_expected_ex2, names(.result_ex2))
  extra_cols_ex2 <- setdiff(names(.result_ex2), cols_expected_ex2)
  
  if (length(missing_cols_ex2) > 0) {
    fail(glue::glue("Your query is missing the following columns: {toString(missing_cols_ex2)}."))
  }
  
  if (length(extra_cols_ex2) > 0) {
    fail(glue::glue("Your query should not include the following columns: {toString(extra_cols_ex2)}."))
  }
  
  # Check for matching row counts
  if (nrow(.result_ex2) != nrow(.solution_ex2)) {
    fail("The number of rows returned by your query does not match the expected result.")
  }
  
  # Check if all values in each column match, allowing for different row orders
  all_columns_match_ex2 <- TRUE
  for (column in cols_expected_ex2) {
    if (!identical(sort(.result_ex2[[column]]), sort(.solution_ex2[[column]]))) {
      all_columns_match_ex2 <- FALSE
      break
    }
  }
  
  if (!all_columns_match_ex2) {
    fail("The values returned by your query do not match the expected result in one or more columns.")
  }
  
  # If all checks pass
  pass("Your query appears to be correct.")
})
```

3. Select the FAA code and name from the `airports` table.

```{sql query3, exercise=TRUE, exercise.eval=FALSE}
-- Write your SQL query here to select the FAA code and name from the airports table
```

```{sql query3-hint-1}
-- HINT: The syntax for selecting specific columns from a table is:
SELECT ___, ___
FROM ___;
```

```{sql query3-hint-2}
-- HINT: You need to specify the columns and table you're selecting from:
SELECT faa, ___
FROM airports;
```

```{sql query3-solution}
-- SOLUTION: Here is one way to select the FAA code and name from the airports table:
SELECT faa, name
FROM airports;
```

```{r query3-check, echo=FALSE}
grade_this({
  # Execute the solution query to get the correct result
  .solution_ex3 <- DBI::dbGetQuery(con, .solution_code)
  
  # Execute the student's query
  .result_ex3 <- DBI::dbGetQuery(con, .user_code)
  
  # Dynamically get expected columns from the solution for EXERCISE 3
  cols_expected_ex3 <- names(.solution_ex3)
  
  # Check for missing or extra columns
  missing_cols_ex3 <- setdiff(cols_expected_ex3, names(.result_ex3))
  extra_cols_ex3 <- setdiff(names(.result_ex3), cols_expected_ex3)
  
  if (length(missing_cols_ex3) > 0) {
    fail(glue::glue("Your query is missing the following columns: {toString(missing_cols_ex3)}."))
  }
  
  if (length(extra_cols_ex3) > 0) {
    fail(glue::glue("Your query should not include the following columns: {toString(extra_cols_ex3)}."))
  }
  
  # Check for matching row counts
  if (nrow(.result_ex3) != nrow(.solution_ex3)) {
    fail("The number of rows returned by your query does not match the expected result.")
  }
  
  # Check if all values in each column match, allowing for different row orders
  all_columns_match_ex3 <- TRUE
  for (column in cols_expected_ex3) {
    if (!identical(sort(.result_ex3[[column]]), sort(.solution_ex3[[column]]))) {
      all_columns_match_ex3 <- FALSE
      break
    }
  }
  
  if (!all_columns_match_ex3) {
    fail("The values returned by your query do not match the expected result in one or more columns.")
  }
  
  # If all checks pass
  pass("Your query appears to be correct.")
})
```

## Aliasing

4. Select and alias specific columns from the airports table

```{sql query4, exercise=TRUE, exercise.eval=FALSE}
-- Write your SQL query here to select the FAA code, name, 
-- and alt from the airports table with aliases of 
-- code, airport_name, and altitude, respectively
```


```{sql query4-hint-1}
-- HINT: Start by selecting columns and use AS to give them aliases. For example:
SELECT column_name AS alias_name
FROM table_name;
```


```{sql query4-hint-2}
-- HINT: Your query should look something like this, fill in the blanks:
SELECT faa AS code, name AS ___, alt AS ___
FROM airports;
```


```{sql query4-solution}
-- SOLUTION: Here is how you can select and alias the FAA code, name, and altitude from the airports table:
SELECT faa AS code, name AS airport_name, alt AS altitude
FROM airports;
```


```{r query4-check, echo=FALSE}
grade_this({
  # Execute the solution query to get the correct result for EXERCISE 4
  .solution_ex4 <- DBI::dbGetQuery(con, "SELECT faa AS code, name AS airport_name, alt AS altitude FROM airports;")
  
  # Execute the student's query for EXERCISE 4
  .result_ex4 <- DBI::dbGetQuery(con, .user_code)
  
  # Dynamically get expected columns from the solution for EXERCISE 4
  cols_expected_ex4 <- names(.solution_ex4)
  
  # Check for missing or extra columns in the student's result
  missing_cols_ex4 <- setdiff(cols_expected_ex4, names(.result_ex4))
  extra_cols_ex4 <- setdiff(names(.result_ex4), cols_expected_ex4)
  
  if (length(missing_cols_ex4) > 0) {
    fail(glue::glue("Your query is missing the following columns: {toString(missing_cols_ex4)}."))
  }
  
  if (length(extra_cols_ex4) > 0) {
    fail(glue::glue("Your query should not include the following columns: {toString(extra_cols_ex4)}."))
  }
  
  # Check if the number of rows and values in each column match the solution
  if (nrow(.result_ex4) != nrow(.solution_ex4)) {
    fail("The number of rows returned by your query does not match the expected result.")
  }
  
  all_columns_match_ex4 <- TRUE
  for (column in cols_expected_ex4) {
    if (!identical(sort(.result_ex4[[column]]), sort(.solution_ex4[[column]]))) {
      all_columns_match_ex4 <- FALSE
      break
    }
  }
  
  if (!all_columns_match_ex4) {
    fail("The values returned by your query do not match the expected result in one or more columns.")
  }
  
  # If all checks pass
  pass("Your query appears to be correct.")
})
```

5. Choose the destination airport code and air time from the flights table with an alias

```{sql query5, exercise=TRUE, exercise.eval=FALSE}
-- Write your SQL query here to select the destination airport code and air time from the flights table with an alias
```

```{sql query5-hint-1}
-- HINT: Use the SELECT statement to choose columns and AS to alias the table. For example:
SELECT column_name
FROM table_name AS table_alias;
```

```{sql query5-hint-2}
-- HINT: Your query should include the table alias and select specific columns like this:
SELECT f.dest, f.air_time
FROM flights AS f;
```

```{sql query5-solution}
-- SOLUTION: Here's how to select the destination airport code and air time from the flights table using an alias:
SELECT f.dest, f.air_time
FROM flights AS f;
```

```{r query5-check, echo=FALSE}
grade_this({
  # Execute the solution query to get the correct result for EXERCISE 5
  .solution_ex5 <- DBI::dbGetQuery(con, "SELECT dest, air_time FROM flights AS f;")
  
  # Execute the student's query for EXERCISE 5
  .result_ex5 <- DBI::dbGetQuery(con, .user_code)
  
  # Dynamically get expected columns from the solution for EXERCISE 5
  cols_expected_ex5 <- names(.solution_ex5)
  
  # Check for missing or extra columns in the student's result
  missing_cols_ex5 <- setdiff(cols_expected_ex5, names(.result_ex5))
  extra_cols_ex5 <- setdiff(names(.result_ex5), cols_expected_ex5)
  
  if (length(missing_cols_ex5) > 0) {
    fail(glue::glue("Your query is missing the following columns: {toString(missing_cols_ex5)}."))
  }
  
  if (length(extra_cols_ex5) > 0) {
    fail(glue::glue("Your query should not include the following columns: {toString(extra_cols_ex5)}."))
  }
  
  # Check if the number of rows and values in each column match the solution
  if (nrow(.result_ex5) != nrow(.solution_ex5)) {
    fail("The number of rows returned by your query does not match the expected result.")
  }
  
  all_columns_match_ex5 <- TRUE
  for (column in cols_expected_ex5) {
    if (!identical(sort(.result_ex5[[column]]), sort(.solution_ex5[[column]]))) {
      all_columns_match_ex5 <- FALSE
      break
    }
  }
  
  if (!all_columns_match_ex5) {
    fail("The values returned by your query do not match the expected result in one or more columns.")
  }
  
  # If all checks pass
  pass("Your query appears to be correct.")
})
```

## Unique entries


6. Select all distinct time zones (`tz`) from the `airports` table.

```{sql query6, exercise=TRUE, exercise.eval=FALSE}
-- Write your SQL query here to select all distinct time zones from
-- the airports table
```


```{sql query6-hint-1}
-- HINT: Use SELECT DISTINCT to get unique values from a column. For example:
SELECT DISTINCT column_name
FROM table_name;
```

```{sql query6-hint-2}
-- HINT: Fill in the blank with the appropriate column name:
SELECT DISTINCT ___
FROM airports;
```

```{sql query6-solution}
-- SOLUTION: Here's how to select all distinct time zones from the airports table:
SELECT DISTINCT tz
FROM airports;
```

```{r query6-check, echo=FALSE}
grade_this({
  # Execute the solution query to get the correct result for EXERCISE 6
  .solution_ex6 <- DBI::dbGetQuery(con, "SELECT DISTINCT tz FROM airports;")
  
  # Execute the student's query for EXERCISE 6
  .result_ex6 <- DBI::dbGetQuery(con, .user_code)
  
  # Expecting only the 'tz' column in the result
  cols_expected_ex6 <- names(.solution_ex6)
  
  # Check for missing or extra columns in the student's result
  missing_cols_ex6 <- setdiff(cols_expected_ex6, names(.result_ex6))
  extra_cols_ex6 <- setdiff(names(.result_ex6), cols_expected_ex6)
  
  if (length(missing_cols_ex6) > 0) {
    fail(glue::glue("Your query is missing the 'tz' column."))
  }
  
  if (length(extra_cols_ex6) > 0) {
    fail(glue::glue("Your query should not include columns other than 'tz'."))
  }
  
  # Check if the number of rows matches the solution
  if (nrow(.result_ex6) != nrow(.solution_ex6)) {
    fail("The number of distinct time zones returned by your query does not match the expected result.")
  }
  
  # If all checks pass
  pass("Your query correctly retrieves all distinct time zones from the airports table.")
})
```


## View creation

7. Create a view named `flight_details` to select carrier and destination from the flights table

```{sql query7, exercise=TRUE, exercise.eval=FALSE}
-- Write your SQL query here to create a view that selects the carrier
-- and destination from the flights table
```

```{sql query7-hint-1}
-- HINT: To create a view, use the CREATE VIEW statement followed by SELECT. For example:
CREATE VIEW view_name AS
SELECT column1, column2
FROM table_name;
```

```{sql query7-hint-2}
-- HINT: Define the view to include the carrier and destination columns from the flights table:
CREATE VIEW flight_details AS
SELECT ___, ___
FROM ___;
```

```{sql query7-solution}
-- SOLUTION: Here's how to create a view for carrier and destination from the flights table:
CREATE VIEW flight_details AS
SELECT carrier, dest
FROM flights;
```

```{r query7-check, echo=FALSE}
grade_this({
  # Since CREATE VIEW operations don't return a conventional result set,
  # you might need to check if the view exists and has the correct structure.
  # This grading code is a simplified example and may need adjustment for actual use.

  # Check if the view exists
  views <- dbListTables(con)
  if (!"flight_details" %in% views) {
    fail("The view 'flight_details' was not created.")
  } else {
    # If the view exists, check its structure
    .result_view <- DBI::dbGetQuery(con, "SELECT * FROM flight_details LIMIT 0;")
    cols_expected_view <- c("carrier", "dest")
    
    missing_cols_view <- setdiff(cols_expected_view, names(.result_view))
    extra_cols_view <- setdiff(names(.result_view), cols_expected_view)
    
    if (length(missing_cols_view) > 0) {
      fail(glue::glue("The view 'flight_details' is missing the following columns: {toString(missing_cols_view)}."))
    }
    
    if (length(extra_cols_view) > 0) {
      fail(glue::glue("The view 'flight_details' should not include the following columns: {toString(extra_cols_view)}."))
    }
    
    # If all checks pass
    pass("The view 'flight_details' was created successfully with the correct structure.")
  }
})
```

8. Select All Columns from the flight_details View

```{sql query8, exercise=TRUE, exercise.eval=FALSE}
-- Write your SQL query here to select all columns from the flight_details view
```

```{sql query8-hint-1}
-- HINT: To select all columns from a view or table, use the asterisk (*) symbol. For example:
SELECT * 
FROM view_name;
```

```{sql query8-hint-2}
-- HINT: Use the SELECT * statement to retrieve all columns from the flight_details view:
SELECT ___
FROM ___;
```

```{sql query8-solution}
-- SOLUTION: Here's how to select all columns from the flight_details view:
SELECT * 
FROM flight_details;
```

```{r query8-check, echo=FALSE}
grade_this({
  # Execute the solution query to get the correct result for EXERCISE 8
  .solution_ex8 <- DBI::dbGetQuery(con, "SELECT * FROM flight_details;")
  
  # Execute the student's query for EXERCISE 8
  .result_ex8 <- DBI::dbGetQuery(con, .user_code)
  
  # Since the view 'flight_details' structure is predefined, we expect all its columns
  cols_expected_ex8 <- names(.solution_ex8)
  
  # Check for missing or extra columns in the student's result
  missing_cols_ex8 <- setdiff(cols_expected_ex8, names(.result_ex8))
  extra_cols_ex8 <- setdiff(names(.result_ex8), cols_expected_ex8)
  
  if (length(missing_cols_ex8) > 0) {
    fail(glue::glue("Your query is missing columns from the 'flight_details' view."))
  }
  
  if (length(extra_cols_ex8) > 0) {
    fail(glue::glue("Your query should not include extra columns not present in the 'flight_details' view."))
  }
  
  # Check if the number of rows matches the solution
  if (nrow(.result_ex8) != nrow(.solution_ex8)) {
    fail("The number of rows returned by your query does not match the expected result.")
  }
  
  # If all checks pass
  pass("Your query correctly retrieves all columns from the 'flight_details' view.")
})
```

## Counting

9. Count the Records in the Flights Table (aliased as `total_flights`)


```{sql query9, exercise=TRUE, exercise.eval=FALSE}
-- Write your SQL query here to count all records in the flights table
```

```{sql query9-hint-1}
-- HINT: Use the COUNT() function to count the number of records. For example:
SELECT COUNT(*) AS alias
FROM table_name;
```


```{sql query9-hint-2}
-- HINT: Apply the COUNT() function to the flights table to count all its records:
SELECT ___ AS ___
FROM ___;
```


```{sql query9-solution}
-- SOLUTION: Here's how to count all records in the flights table:
SELECT COUNT(*) AS total_flights
FROM flights;
```


```{r query9-check, echo=FALSE}
grade_this({
  # Execute the solution query to get the correct result for EXERCISE 9
  .solution_ex9 <- DBI::dbGetQuery(con, "SELECT COUNT(*) AS total_flights FROM flights;")
  
  # Execute the student's query for EXERCISE 9
  .result_ex9 <- DBI::dbGetQuery(con, .user_code)
  
  # Expecting a single column named 'total_flights' in the result
  cols_expected_ex9 <- names(.solution_ex9)
  
  # Check for missing or extra columns in the student's result
  missing_cols_ex9 <- setdiff(cols_expected_ex9, names(.result_ex9))
  extra_cols_ex9 <- setdiff(names(.result_ex9), cols_expected_ex9)
  
  if (length(missing_cols_ex9) > 0) {
    fail(glue::glue("Your query is missing the 'total_flights' column."))
  }
  
  if (length(extra_cols_ex9) > 0) {
    fail(glue::glue("Your query should not include extra columns not present in the expected result."))
  }
  
  # Check if the count value matches the solution
  if (.result_ex9$total_flights != .solution_ex9$total_flights) {
    fail("The total count of flights returned by your query does not match the expected result.")
  }
  
  # If all checks pass
  pass("Your query correctly counts all records in the flights table.")
})
```

10. Count all distinct carriers in the flights table

```{sql query10, exercise=TRUE, exercise.eval=FALSE}
-- Write your SQL query here to count all distinct carriers in the flights table.
```

```{sql query10-hint-1}
-- HINT: To count unique values from a column, use
SELECT COUNT(DISTINCT column) 
FROM table_name;
```

```{sql query10-hint-2}
-- HINT: Fill in the blank to complete the query for counting distinct carriers.
SELECT COUNT(DISTINCT ___) 
FROM flights;
```

```{sql query10-solution}
-- SOLUTION: This query counts all distinct carriers in the flights table.
SELECT COUNT(DISTINCT carrier) 
FROM flights;
```

```{r query10-check, echo=FALSE}
grade_this({
  # Execute the solution query to get the correct result for EXERCISE 10
  .solution_ex10 <- DBI::dbGetQuery(con, "SELECT COUNT(DISTINCT carrier) AS total_distinct_carriers FROM flights;")
  
  # Execute the student's query for EXERCISE 10
  .result_ex10 <- DBI::dbGetQuery(con, .user_code)
  
  # Expecting a single column named 'total_distinct_carriers' in the result
  cols_expected_ex10 <- names(.solution_ex10)
  
  # Check for missing or extra columns in the student's result
  missing_cols_ex10 <- setdiff(cols_expected_ex10, names(.result_ex10))
  extra_cols_ex10 <- setdiff(names(.result_ex10), cols_expected_ex10)
  
  if (length(missing_cols_ex10) > 0) {
    fail(glue::glue("Your query is missing the 'total_distinct_carriers' column."))
  }
  
  if (length(extra_cols_ex10) > 0) {
    fail(glue::glue("Your query should not include extra columns not present in the expected result."))
  }
  
  # Check if the count value matches the solution
  if (.result_ex10$total_distinct_carriers != .solution_ex10$total_distinct_carriers) {
    fail("The total count of distinct carriers returned by your query does not match the expected result.")
  }
  
  # If all checks pass
  pass("Your query correctly counts all distinct carriers in the flights table.")
})
```

# Filtering Techniques

## Filtering rows/records

11. Select Boeing Planes' Tail Numbers and Models

```{sql query11, exercise=TRUE, exercise.eval=FALSE}
-- Write your SQL query here to select tail numbers and models 
-- of all Boeing planes.
```

```{sql query11-hint-1}
-- HINT: Use a WHERE clause to filter for specific conditions. Syntax example:
SELECT column1, column2 
FROM table_name 
WHERE condition;
```

```{sql query11-hint-2}
-- HINT: Fill in the blanks to select tail numbers and models from the planes table for Boeing planes.
SELECT ___, ___ 
FROM planes 
WHERE manufacturer = '___';
```

```{sql query11-solution}
-- SOLUTION: This query selects tail numbers and models of planes manufactured by Boeing.
SELECT tailnum, model 
FROM planes 
WHERE manufacturer = 'BOEING';
```

```{r query11-check, echo=FALSE}
grade_this({
  .solution_query11 <- "SELECT tailnum, model FROM planes WHERE manufacturer = 'BOEING';"
  .solution_ex11 <- DBI::dbGetQuery(con, .solution_query11)
  .result_ex11 <- DBI::dbGetQuery(con, .user_code)
  
  # Check for missing or extra columns in the student's result
  cols_expected_ex11 <- names(.solution_ex11)
  missing_cols_ex11 <- setdiff(cols_expected_ex11, names(.result_ex11))
  extra_cols_ex11 <- setdiff(names(.result_ex11), cols_expected_ex11)

  if (length(missing_cols_ex11) > 0) {
    fail(glue::glue("Your query is missing the following columns: {toString(missing_cols_ex11)}."))
  }

  if (length(extra_cols_ex11) > 0) {
    fail(glue::glue("Your query includes extra columns not expected: {toString(extra_cols_ex11)}."))
  }
  
  # Check the correctness of the result
  if (!all(.result_ex11$tailnum %in% .solution_ex11$tailnum) || !all(.result_ex11$model %in% .solution_ex11$model)) {
    fail("The tail numbers and/or models returned by your query do not match the expected result. Ensure you're filtering for Boeing planes.")
  }

  pass("Correct! Your query successfully retrieved tail numbers and models of Boeing planes.")
})
```

## Filtering text

# Aggregating Techniques

## Numerical summaries

## Categorical summaries

## Rounding summaries

# Sorting and Grouping Techniques

## Sorting

## Grouping

# Transforming Techniques

# Joining Techniques

## INNER JOIN

## LEFT JOIN

## RIGHT JOIN

## Anti-Join
